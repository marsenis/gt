% --- To be compiled with XeLaTeX ---
% ---      Encoding: UTF-8        ---

\documentclass[a4paper, oneside, 11pt]{article}

%fontspec package provides a configurable interface for font selection, and allows complex font choices to be named and later reused. It's needed for XeLaTeX
\usepackage[cm-default]{fontspec}

% Unicode support
\usepackage{xunicode}
\usepackage{xltxtra}

% Default words and phrases in Greek (e.g. 'Περίληψη' instead of 'Abstract'). Also contains hyphenation rules for Greek Language
\usepackage{xgreek}

% Mathematical fonts, theorems etc.
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}

% Default page layout for consuming a larger portion of the page.
\usepackage{fullpage}

% Greek fonts (Computer Modern)
\setmainfont[Mapping=tex-text]{CMU Serif}

% Auxiliary commands
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\newtheorem{thm}{Θεώρημα}
\newtheorem{lm}[thm]{Λήμμα}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Ορισμός}

\newcommand{\pr}{\mathbb{P}}
\newcommand{\ex}{\mathbb{E}}

\begin{document}

\input{title.tex}

\begin{enumerate}

\item[1.]
   Σε ένα $G(n, p)$ η πιθανότητα μιας κορυφής να έχει βαθμό $k$ είναι
   ${n-1 \choose k} p^k (1-p)^{n-1-k}$. Δείξτε ότι ο μέσος βαθμός είναι
   $(n-1)p$ με απευθείας υπολογισμό, δηλαδή χωρίς να χρησιμοποιήσετε τη
   γραμμικότητα της μέσης τιμής.

   \begin{proof}

      Θα χρειαστούμε τα εξής λήμματα:

      \begin{lm}
         \label{lm1.1}
         Έστω δύο τ.μ. που ακολουθούν κατανομή Bernoulli με παραμέτρους $n, p$
         και $m, p$ αντίστοιχα, δηλαδή $X \sim B(n, p), Y \sim B(m, p)$. Τότε για το
         άθροισμά τους ισχύει $X + Y \sim B(n + m, p)$.
      \end{lm}
      \begin{proof}
         \begin{align*}
            \pr[X + Y = k]
               &= \pr[(X = 0 \land Y = k) \lor (X = 1 \land Y = k-1) \lor
               \ldots \lor (X = k \land Y = 0) ] \\
               &= \sum_{i=0}^{k} \pr[X = i \land Y = k - i]\\
               &= \sum_{i=0}^{k} \pr[X = i] \cdot \pr[Y = k - i]\\
               &= \sum_{i=0}^{k} {n \choose i} p^i (1-p)^{n-i}
                                 {m \choose k-i} p^{k-i} (1-p)^{m - (k-i)}\\
               &= p^k (1-p)^{n + m - k} \sum_{i=0}^{k} { n \choose i }
                  {m \choose k - i}\\
               &= { n+m \choose k } p^k (1-p)^{n+m-k}\\
         \end{align*}
      \end{proof}

      \begin{lm}
         \label{lm1.2}
         Έστω $\{X_i\}_{i = 1 \ldots k}$ μια οικογένεια τ.μ. για τις οποίες
         ισχύει $X_i \sim B(n_i, p)$. Τότε $\sum_{i=1}^{k} X_i \sim B \left(
         \sum_{i=1}^{k} n_i, p \right)$.
      \end{lm}
      \begin{proof}
         Χρησιμοποιώντας το Λήμμα \ref{lm1.1} και επαγωγή στο $k$ προκύπτει το
         ζητούμενο.
      \end{proof}

      \begin{lm}
         \label{lm1.3}
         Αν $X \sim B(n, p)$ τότε $\ex[X] = np$.
      \end{lm}
      \begin{proof}
         \begin{align*}
            \ex[X] &= \sum_{i=0}^{n} i \cdot \pr[X = i]\\
                   &= \sum_{i=0}^{n} i {n \choose i} p^i (1-p)^{n-i}\\
                   &= \sum_{i=1}^{n} np {n-1 \choose i-1} p^{i-1}
                      (1-p)^{(n-1) - (i-1)}\\
                   &= np \sum_{i=0}^{n-1} {n-1 \choose i} p^{i}
                      (1-p)^{(n-1) - i}\\
                   &= np \cdot (p + (1-p))^{n-1} = np\\
         \end{align*}
      \end{proof}

      Για το γράφημα $G(n, p)$ έχουμε
      ότι ο βαθμός μιας κορυφής $v_i$ είναι μια τυχαία μεταβλητή $d_i$ που ακολουθεί
      την κατανομή Bernoulli με παραμέτρους $n-1, p$, δηλαδή $d_i \sim B(n-1,
      p)$.

      Για τον μέσο βαθμό κορυφής ισχύει:

      \[ d(G) = \frac{\sum_{i=1}^{n} d_i}{n} \]

      όπου $X = \sum_{i=1}^{n} d_i$.
      
      Σύμφωνα με το Λήμμα \ref{lm1.2} έχουμε ότι $X \sim B \left(\sum_{i=1}^{n}
      (n-1), p \right) = B( n(n-1), p)$.

      Από το Λήμμα \ref{lm1.3}, $\ex[X] = n(n-1)p$. Άρα έχουμε ότι:

      \[ \ex[d(G)] = \frac1n \ex[X] = (n-1)p \]
   \end{proof}

\item[2.]
   Δείξτε ότι το τυχαίο γράφημα $G(n, p)$ με $p = n^{-0.7}$ δεν έχει σχεδόν
   σίγουρα 4-κλίκα για αρκετά μεγάλα $n$.

   \begin{proof}
   \end{proof}

\item[3. ($\star$)]
   Θεωρήστε το παρακάτω τυχαίο κατευθονόμενο γράφημα. Για κάθε κορυφή $v$
   επιλέγουμε ομοιόμορφα τυχαία μια κορυφή $u$ και τοποθετούμε την ακμή
   $v \rightarrow u$. Κάθε κορυφή έχει μόνο μια εξερχόμενη ακμή και μπορεί να
   υπάρχουν θηλιές. Έστω $r(v)$ ο αριθμός των κορυφών στις οποίες μπορούμε να
   φτάσουμε από την $v$.

   \begin{itemize}
      \item Για $k = 1, \ldots, n$ ποιά η πιθανότητα $r(v) = k$. Η πιθανότητα θα
            έχει μορφή γινομένου.
      \item Δείξτε ότι για μία κορυφή $v$, $Pr[ r(v) \leq \sqrt{n} / 10 ]
            \leq 1/3$ και $Pr [ r(v) \geq 10\sqrt{n} ] \leq 1/3$.
   \end{itemize}

   \begin{proof}
   \end{proof}

\item[4. ($\star$)]
   Θεωρήστε το τυχαίο γράφημα $G(n, p)$ με $p = 6.6/n$. Δείξτε ότι το γράφημα
   είναι σχεδόν σίγουρα μή 3-χρωματίσιμο για αρκετά μεγάλα $n$.

   \begin{proof}
Έστω $X$ η τυχαία μεταβλητή που αντιστοιχεί στο πλήθος των 3-χρωματισμών του γραφήματός μας. Αν σταθεροποιήσουμε το πλήθος των κορυφών που έχουν το κάθε χρώμα, θεωρήσουμε δηλαδή ότι υπάρχουν $x$ κορυφές
με το πρώτο χρώμα, $y$ κορυφές με το δεύτερο χρώμα και $n-x-y$ κορυφές με το τρίτο χρώμα, τότε ο αναμενόμενος αριθμός 3-χρωματισμών του γραφήματός μας είναι $\frac{n!}{x!y!(n-x-y)!} \cdot 
(1-p)^{{x \choose 2} + {y\choose 2} + {n-x-y\choose 2}}$. Ο πρώτος παράγοντας αντιστοιχεί στο πλήθος τρόπων για την αντιστοίχιση χρωμάτων στις κορυφές και ο δεύτερος στην πιθανότητα να μην έχουμε ακμές
μεταξύ κορυφών ίδιου χρώματος. Συνολικά, λοιπόν, έχουμε $E[X] = \sum_{x=0}^{n} \sum_{y=0}^{n-x} \frac{n!}{x!y!(n-x-y)!}\cdot (1-p)^{{x\choose 2}+{y\choose 2}+{n-x-y\choose 2}}$.
Τώρα, γνωρίζουμε ότι η έκφραση $\frac{n!}{x!y!(n-x-y)!}$ μεγιστοποιείται για $x=y=\frac{n}{3}$ και η μέγιστη τιμή της είναι $\frac{n!}{\frac{n}{3}!^3}$. Αντίστοιχα, η ${{x \choose 2} + {y\choose 2} + {n-x-y\choose 2}}$ 
ελαχιστοποιείται για $x=y=\frac{n}{3}$, και επειδή $1-p<1$, έχουμε από τα παραπάνω ότι $E[X] \leq \sum_{x=0}^{n}\sum_{y=0}^{n-x} \frac{n!}{\frac{n}{3}!^3} (1-p)^{3\cdot {\frac{n}{3}\choose 2}}$.
Όμως $(1-p)^{3\cdot {\frac{n}{3}\choose 2}}\leq e^{-p\cdot {3\cdot {\frac{n}{3}\choose 2}}}=e^{-\frac{6.6}{n}\cdot {\frac{3}{2}\cdot \frac{n}{3}\cdot (\frac{n}{3}-1)}}=e^{-1.1n}\cdot e^{3.3}$.
Επίσης, χρησιμοποιώντας τη διπλή ανισότητα $e(\frac{n}{e})^n \leq n! \leq e(\frac{n+1}{e})^{n+1}$, παίρνουμε ότι $\frac{n!}{\frac{n}{3}!^3}\leq \frac{e(\frac{n+1}{e})^{n+1}}{e^3 (\frac{n}{3e})^n
}=e^{-3} \cdot (\frac{n+1}{n})^n \cdot (n+1) \cdot 3^{n} \leq e^{-2} \cdot n^2 \cdot 3^{n}$. Συνολικά έχουμε ότι $E[X] \leq n^2 \cdot e^{-2} \cdot n^2 \cdot 3^{n}\cdot e^{-1.1n}\cdot e^{3.3}\leq 
n^4 \cdot e^{1.3}\cdot (\frac{e^{ln3}}{e^{1.1}})^n \leq n^4\cdot e^{1.3}\cdot e^{-0.001n}$, το οποίο τείνει στο 0 όταν το $n$ τείνει στο άπειρο. Άρα για αρκετά μεγάλο $n$ έχουμε ότι ο μέσος αριθμός
3-χρωματισμών του γραφήματος τείνει στο μηδέν, άρα και η πιθανότητα να υπάρχει 3-χρωματισμός τείνει στο 0. Άρα σχεδόν σίγουρα το γράφημα δεν είναι 3-χρωματίσιμο.
   \end{proof}

Λήμμα 1: Το $\frac{n!}{x!y!(n-x-y)!}$ μεγιστοποιείται για $x=y=\frac{n}{3}$.
\begin{proof}
Έστω ότι το ζητούμενο δεν ισχύει και $A$ η μέγιστη τιμή της παράστασης και χωρίς βλάβη της γενικότητας $x<\frac{n}{3}$ και $y>\frac{n}{3}$. Θεωρούμε $x'=x+1$ και $y'=y-1$. Τότε η νέα τιμή της παράστασης
είναι $A'=\frac{n!}{(x+1)!(y-1)!(n-x-y)!} = A \cdot \frac{y}{x+1}\geq A$. Αυτό είναι άτοπο, άρα το ζητούμενο ισχύει.
\end{proof}

Λήμμα 2: Το ${x \choose 2} + {y\choose 2} + {n-x-y \choose 2}$ ελαχιστοποιείται για $x=y=\frac{n}{3}$.
\begin{proof}
Η παραπάνω παράσταση είναι ίση με $\frac{1}{2} (x^2 + y^2 + (n-x-y)^2 - (x+y+n-x-y)) \geq_{cauchy-schwarz} \frac{1}{2}(\frac{1}{3} n^2 - n)$. Η ισότητα πραγματοποιείται όταν $x=y=n-x-y$, δηλαδή $x=y=\frac{n}{3}$.
\end{proof}

\item[5. ($\star$)]
   Θεωρήστε το παρακάτω τυχαίο γράφημα με $n$ κορυφές. Κάθε κορυφή διαλέγει
   ομοιόμορφα τυχαία 2 κορυφές και τοποθετούμε μη-κατευθυνόμενες ακμές προς
   αυτές. Η τυχαία επιλογή γίνεται με επανάληψη και μπορεί μια κορυφή $v$ να
   επιλέξει και τον εαυτό της στην οποία περίπτωση παραλείπουμε αυτή τη θηλιά.
   Παρατηρούμε ότι οι ακμές θα είναι περίπου $2n$ αλλά μπορεί κάποιες κορυφές να
   έχουν βαθμό μικρότερο από $2$ αν επέλεξαν τον εαυτό τους ή την ίδια κορυφή
   δύο φορές. Μπορεί επίσης κάποιες κορυφές να έχουν βαθμό αρκετά μεγαλύτερο από
   $4$ αν άλλες κορυφές έτυχε να τις επιλέξουν.

   Δείξτε ότι το γράφημα είναι σχεδόν σίγουρα συνεκτικό για αρκετά μεγάλα $n$.

   \begin{proof}
   \end{proof}

\end{enumerate}

\end{document}
